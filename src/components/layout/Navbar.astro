---
import { mainNavigation } from '../../data/navigation';
---

<nav class="navbar" aria-label="Navegacion principal">
  <ul class="nav-list">
    {
      mainNavigation.map((item) => (
        <li class={`nav-item ${item.children ? 'has-dropdown' : ''}`}>
          <a
            href={item.href}
            class="nav-link link-underline"
            aria-haspopup={item.children ? 'true' : undefined}
            aria-expanded={item.children ? 'false' : undefined}
          >
            {item.label}
            {item.children && (
              <svg
                class="dropdown-arrow"
                xmlns="http://www.w3.org/2000/svg"
                width="12"
                height="12"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <polyline points="6 9 12 15 18 9" />
              </svg>
            )}
          </a>
          {item.children && (
            <ul class="dropdown-menu">
              {item.children.map((child) => (
                <li>
                  <a
                    href={child.href}
                    class={`dropdown-link${child.external ? ' dropdown-link-external' : ''}`}
                    target={child.external ? '_blank' : undefined}
                    rel={child.external ? 'noopener noreferrer' : undefined}
                  >
                    {child.label}
                    {child.external && (
                      <svg xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" style="margin-left:4px;flex-shrink:0">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                        <polyline points="15 3 21 3 21 9"/>
                        <line x1="10" y1="14" x2="21" y2="3"/>
                      </svg>
                    )}
                  </a>
                </li>
              ))}
            </ul>
          )}
        </li>
      ))
    }
  </ul>
</nav>

<style>
  .navbar {
    display: none;
  }

  @media (min-width: 1024px) {
    .navbar {
      display: block;
      flex: 1;
    }
  }

  .nav-list {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: var(--spacing-xs);
  }

  .nav-item {
    position: relative;
  }

  .nav-link {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-sm) var(--spacing-md);
    color: var(--color-white);
    font-weight: var(--font-medium);
    font-size: var(--text-sm);
    transition: opacity var(--transition-fast);
  }

  .nav-link:hover {
    opacity: 0.9;
    color: var(--color-white);
  }

  .nav-link::after {
    background-color: var(--color-white);
  }

  .dropdown-arrow {
    transition: transform var(--transition-fast);
  }

  .has-dropdown:hover .dropdown-arrow {
    transform: rotate(180deg);
  }

  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 220px;
    background-color: var(--color-white);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: opacity var(--transition-base), transform var(--transition-base),
      visibility var(--transition-base);
    padding: var(--spacing-sm) 0;
  }

  .has-dropdown:hover .dropdown-menu,
  .has-dropdown:focus-within .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .dropdown-link {
    display: block;
    padding: var(--spacing-sm) var(--spacing-lg);
    color: var(--color-gray-800);
    font-size: var(--text-sm);
    transition: background-color var(--transition-fast), color var(--transition-fast);
  }

  .dropdown-link:hover {
    background-color: var(--color-gray-50);
    color: var(--color-primary);
  }

  .dropdown-link-external {
    display: flex;
    align-items: center;
    font-weight: var(--font-semibold);
    color: var(--color-primary);
    border-top: 1px solid var(--color-gray-100);
    margin-top: var(--spacing-xs);
    padding-top: var(--spacing-md);
  }

  .dropdown-link-external:hover {
    background-color: var(--color-primary);
    color: var(--color-white);
  }
</style>
